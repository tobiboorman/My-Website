<!DOCTYPE html>
<html lang = "en">
	<head>
		<!-- specifies the character encoding for the HTML document -->
		<meta charset="utf-8" />
		<!-- Viewport: The area of the page visible to user, depending on device -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<!-- Appears on page tab -->
		<title> Tobias Boorman | Fireflies </title>
		<!-- CSS stylesheet --> 
		<link href="../styles.css" rel="stylesheet" />
		<link rel="icon" type="image/png" href="../assets/Favicon.png"/>
	</head>
	<body>
		<!-- A menu bar to go at the top of the page -->
		<nav class="menu">
			<h1> Tobias Boorman </h1>
			<ul>
				<li><a href="../assets/CV.pdf" download>CV</a></li>
				<li><a href="../Outreach.html"> Outreach </a></li>
				<li><a href="../fun.html"> Fun </a></li>
				<li><a href="../index.html"> Home </a></li>
			</ul>
		</nav>
		<hr>
		<!-- Body of post -->
		<section class="blogpostcontent">
			<h1>The Spontaneous Synchronisation of Fireflies</h1>
			
			<h2>Coupled Oscillators</h2>
			<p> Back in November, I found myself curious about spontaneous synchronisation in systems of coupled oscillators. A particularly striking example is the synchronisation of metronomes coupled through a shared medium.</p>
			
			<div class="videoframe">
				<iframe width="100%" height="100%" src="https://www.youtube.com/embed/5v5eBf2KwF8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
			</div>
			
			<p>I wanted to see if I could write a very simple program that replicates this effect, and took very heavy inspiration from the excellent firefly simulation built by <a href="https://ncase.me/fireflies/">Nicky Case</a>.</p>
			
			<h2>Firefly Flashes</h2>
			
			<p>Bioluminescent synchronisation is a phenomenon that has been observed for quite some time. A famous account is that of the German physician and explorer Engelbert Kaempfer, who wrote of his 1680 voyage near Bangkok [1]</p>
			
			<q>The glowworms … represent another shew, which settle
			on some trees, like a fiery cloud, with this surprising
			circumstance, that a whole swarm of these insects,
			having taken possession of one tree, and spread
			themselves over its branches, sometimes hide their light
			all at once, and a moment after make it appear again
			with the utmost regularity and exactness …</q>
			
			<p>For a more contemporary account, we shift our attention to the work of the John and Elisabeth Buck. In 1968, the Bucks published a paper describing their findings on the <q>Mechanism of Rhythmic Synchronous
			Flashing of Fireflies</q> from their visit to Thailand [2]. It was established that at an ambient temperature of 28<span>℃</span> fireflies located in trees flash synchronously
			approximately once every 560ms, with a maximum range of coincidence being around 20ms [2]. As for the title, it was postulated that
			<q>…the initial entrainment could involve progressive phase-shifting, operating either over the whole range of temporal separation or after the rhythms have drifted to within a certain degree of approximation.</q>
			In other words, it was speculated that a firefly may flash in response to observing the flash of a neighbouring firefily, either irrespective of its present state or only if it was already close to flashing. Over time, this mechanism would lead to a grouping effect, where clusters of neighbouring fireflies flash simultaneously (almost like one large firefly), until eventually, the clusters themselves synchronise and the entire collection of fireflies flash in synchrony.</p>
			
			
			<p> The brilliant insight of <a href="https://ncase.me/fireflies/">Nicky Case</a> is that we can translate this to a very simple set of rules, on which I also base my program,</p>
			<ol>
				<li> Each firefly has an internal clock, and, upon one full revolution, the firefly will flash.</li>
				<li> If, within some radius around the firefly, a neighbouring firefly flashes, the internal clock will progress by one tick.</li>
			</ol>
			<p>That’s it! The rest just comes down to how we define the movement of the fireflies, their radius of interaction, and the frequency of their flashes.
			In my program, their movement is merely dictated by a uniform distribution, and in order to avoid grouping at the edges of their container, I impose periodic boundary conditions. Furthermore,
			I make the light of each flash linger on screen for two time steps, helping us to better see where clustering is taking effect. </p>
			
			<p> We can now observe the synchronisation of fireflies:</p>
			<div class="gifframe">
				<img src="../assets/Firefly_movie.gif" alt="Firefly gif" style="width:65%;height:100%;display: block;margin-left: auto; margin-right: auto;" />
			</div>
			<p> Here we are simulating 100 fireflies, and the luminosity at a single point in time is defined as the number of fireflies that are lit up. Initially, the luminosity fluctuates at random, as most fireflies are out-of-sync with one-another. After approximately 100 steps, however, we start to see the effects of clustering,
			with three very well defined peaks. If you look closely, you will see that each peak actually represents two large clusters that are one step out-of-sync with each other (this is due to my choice to allow the light to linger on screen). The fact that these peaks are staggered suggests the existence of a handful of clusters that are almost in-sync with one-another.
			</p>
			
			<p> After approximately 230 steps we begin to see the merging of these clusters, with a decrease in staggering and a rapid increase in amplitude at around 250 steps. 
			At this point, the synchronisation of the whole group is locked in, because the two remaining clusters in the previous step have merged into one <q>super cluster</q>. 
			Indeed, after this, we observe a dramatic increase in the luminosity, which remains periodic.
			</p>
			
			<p> For more information on the Bucks, their lives, and their work, I recommend Ref. [3]. Thank you for reading, I hope you found this interesting!</p>
			
			<h2>References</h2>
			<p> [1] E. Kaempfer, <i>The history of Japan: together with a description of the kingdom of Siam, 1690-92. Vol. 3.</i> J. MacLehose and sons, 1906.</p>
			
			<p> [2] J. Buck and E. Buck, “Mechanism of rhythmic synchronous flashing of fireflies,” Science, vol. 159, no. 3821, pp. 1319-1327, 1968.</p>
			
			<p> [3] J.F. Case, and F.E. Hanson. “The luminous world of John and Elisabeth Buck,” Integrative and Comparative Biology, vol. 44, no. 3, pp. 197-202, 2004.</p>
		</section>
		<!-- Footer -->
		<hr>
		<footer>
			<p> &copy; Tobias Boorman <script>document.write(new Date().getFullYear())</script> </p>
		</footer>
	</body>
</html>
